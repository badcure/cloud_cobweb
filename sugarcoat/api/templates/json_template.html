{% extends 'base.html' %}
{% if json_result.status_code < 299 %}
    {% set header_class="status_code_ok" %}
{% elif json_result.status_code < 399 %}
    {% set header_class="status_code_redirect" %}
{% elif json_result.status_code < 499 %}
    {% set header_class="status_code_bad_request" %}
{% elif json_result.status_code < 599 %}
    {% set header_class="status_code_server_error" %}
{% else %}
    {% set header_class="status_code_unknown" %}
{% endif %}

{% if json_result.response_time < 500 %}
    {% set response_status_class="response_time_great" %}
{% elif json_result.response_time < 1000 %}
    {% set response_status_class="response_time_good" %}
{% elif json_result.response_time < 5000 %}
    {% set response_status_class="response_time_ok" %}
{% else %}
    {% set response_status_class="response_time_bad" %}
{% endif %}


{% block main_body %}

<h1>{{ json_result.method }} - Request</h1>
<span class="request_url_header">{{ json_result.method }} </span> {{ json_result.url }}<br>

<pre id="request_code">{{ json_result.request_headers|print_headers }}</pre>

<h1>Request Body{% if not json_result.request_body %} - Empty{% endif %}</h1>

<div class="json_display">
    <pre id="response_code">{{ json_result.request_body }}</pre>
</div>

    <h1>Response</h1>
    Response Code: <span class="request_url_status_code">{{ json_result.status_code }}</span><br>
    Response Time: <span class="{{ response_status_class }}">{{ (json_result.response_time*1000)|int }} ms</span>

    <div class="json_display">
        <pre id="response_code">{{ json_result.response_headers|print_headers }}</pre>
    </div>
<h1>Data - {{ json_result.result_type }}</h1>
    {% if json_result.safe_html %}
        <div class="json_display">
            <pre id="display_code">{{ json_result.display_with_relation|convert_to_urls|safe }}</pre>
        </div>
    {% else %}
        <div class="json_display">
            <pre id="display_code">{{ json_result.display_with_relation|convert_to_urls }}</pre>
        </div>
    {% endif %}
    {% if g.user_info.token %}
        <h1>Additional Links</h1>
        <table class="table table-striped">
            <thead>
            <tr><td>Additional URL</td></tr>
            </thead>
            <tbody>
                {% for url in additional_urls.links.populated %}
                    <tr><td>{{ url|safe }}</td></tr>
                {% endfor %}
            </tbody>
        </table>
    {%  endif %}
{% endblock %}


